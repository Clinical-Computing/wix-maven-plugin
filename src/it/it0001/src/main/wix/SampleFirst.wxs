<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Name='Foobar 1.0' Id='00000001-86C7-4D14-AEC0-86416A69ABDE' UpgradeCode='00000001-7349-453F-94F6-BCB5110BA4FD'
    Language='1033' Codepage='1252' Version='1.0.0' Manufacturer='Acme Ltd.'>

    <Package Id='*' Keywords='Installer' Description="Acme's Foobar 1.0 Installer"
      Comments='Foobar is a registered trademark of Acme Ltd.' Manufacturer='Acme Ltd.'
      InstallerVersion='301' Languages='1033' Compressed='yes' SummaryCodepage='1252' InstallScope="perMachine" InstallPrivileges="elevated"/>

    <Media Id='1' Cabinet='Sample.cab' EmbedCab='yes' DiskPrompt="CD-ROM #1" />
    <Property Id='DiskPrompt' Value="Acme's Foobar 1.0 Installation [1]" />
	<Property Id="MSIUSEREALADMINDETECTION" Value="1" />
	
    <Directory Id='TARGETDIR' Name='SourceDir'>
    <!-- 
      <Directory Id='ProgramFilesFolder' Name='PFiles'>
        <Directory Id='Acme' Name='Acme'>
          <Directory Id='INSTALLDIR' Name='Foobar 1.0'>

            <Component Id='MainExecutable' Guid='00000001-83F1-4F22-985B-FDB3C8ABD471'>
              <File Id='FoobarEXE' Name='FoobarAppl10.exe' DiskId='1' Source='FoobarAppl10.exe' KeyPath='yes'>
                <Shortcut Id="startmenuFoobar10" Directory="ProgramMenuDir" Name="Foobar 1.0" WorkingDirectory='INSTALLDIR' Icon="Foobar10.exe" IconIndex="0" Advertise="yes" />
                <Shortcut Id="desktopFoobar10" Directory="DesktopFolder" Name="Foobar 1.0" WorkingDirectory='INSTALLDIR' Icon="Foobar10.exe" IconIndex="0" Advertise="yes" />
              </File>
            </Component>

            <Component Id='HelperLibrary' Guid='00000001-6BE3-460D-A14F-75658D16550B'>
              <File Id='HelperDLL' Name='Helper.dll' DiskId='1' Source='Helper.dll' KeyPath='yes' />
            </Component>

            <Component Id='Manual' Guid='00000001-574D-4A9A-A266-5B5EC2C022A4'>
              <File Id='Manual' Name='Manual.pdf' DiskId='1' Source='Manual.pdf' KeyPath='yes'>
                <Shortcut Id="startmenuManual" Directory="ProgramMenuDir" Name="Instruction Manual" Advertise="yes" />
              </File>
            </Component>

          </Directory>
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuDir" Name="Foobar 1.0">
          <Component Id="ProgramMenuDir" Guid="00000001-7E98-44CE-B049-C477CC0A2B00">
            <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
            <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
          </Component>
        </Directory>
      </Directory>

      <Directory Id="DesktopFolder" Name="Desktop" />
       -->
    </Directory>

    <Component Id='MMC' Guid='997529ED-899B-491C-95BB-18637E051861' Directory='TARGETDIR'>
    <!-- Register our extension classes -->
    <!-- Register our extension to the node types -->
      <!-- 
      Container
      <RegistryValue Root="HKLM" Key="Software\Microsoft\MMC\NodeTypes\{BF967A8B-0DE6-11D0-A285-00AA003049E2}\Extensions\PropertySheet" Type="String" Name="{FE37A6C4-8B86-4011-AE6F-013011FDC20E}" Value="SecureLogin MMC AD User & Computer Extension (container)"/>
      OrgUnit
      <RegistryValue Root="HKLM" Key="Software\Microsoft\MMC\NodeTypes\{bf967aa5-0de6-11d0-a285-00aa003049e2}\Extensions\PropertySheet" Type="String" Name="{FE37A6C4-8B86-4011-AE6F-013011FDC20E}" Value="SecureLogin MMC AD User & Computer Extension (organizationUnit)"/>
      User
      <RegistryValue Root="HKLM" Key="Software\Microsoft\MMC\NodeTypes\{bf967aba-0de6-11d0-a285-00aa003049e2}\Extensions\PropertySheet" Type="String" Name="{FE37A6C4-8B86-4011-AE6F-013011FDC20E}" Value="SecureLogin MMC AD User & Computer Extension (user)"/>
          -->
      <!-- inetOrgPerson -->
      <RegistryValue Root="HKLM" Key="Software\Microsoft\MMC\NodeTypes\{4828cc14-1437-45bc-9b07-ad6f015e5f28}\Extensions\PropertySheet" Type="string" Name="{FE37A6C4-8B86-4011-AE6F-013011FDC20E}" Value="SecureLogin MMC AD User and Computer Extension (inetOrgPerson)"/>
      <!-- userProxy -->
      <RegistryValue Root="HKLM" Key="Software\Microsoft\MMC\NodeTypes\{60d6186f-f3b6-4898-b0ad-6535afc07620}\Extensions\PropertySheet" Type="string" Name="{FE37A6C4-8B86-4011-AE6F-013011FDC20E}" Value="SecureLogin MMC AD User and Computer Extension (userProxy)"/>
    
    <!-- Extend the known node types for AD Users and Computers snapin -->
      <!-- User
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{E355E538-1C2E-11D0-8C37-00C04FD8FE93}\NodeTypes\{bf967aba-0de6-11d0-a285-00aa003049e2}"/>
      Container
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{E355E538-1C2E-11D0-8C37-00C04FD8FE93}\NodeTypes\{BF967A8B-0DE6-11D0-A285-00AA003049E2}"/>
      OrgUnit
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{E355E538-1C2E-11D0-8C37-00C04FD8FE93}\NodeTypes\{bf967aa5-0de6-11d0-a285-00aa003049e2}"/>
      -->
      <!-- inetOrgPerson -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{E355E538-1C2E-11D0-8C37-00C04FD8FE93}\NodeTypes\{4828cc14-1437-45bc-9b07-ad6f015e5f28}"/>
      <!-- userProxy -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{E355E538-1C2E-11D0-8C37-00C04FD8FE93}\NodeTypes\{60d6186f-f3b6-4898-b0ad-6535afc07620}"/>
    <!-- Extend the known node types for ServerManager - AD Users and Computers snapin -->
      <!-- User -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{006A2A75-547F-11D1-B930-00A0C9A06D2D}\NodeTypes\{bf967aba-0de6-11d0-a285-00aa003049e2}"/>
      <!-- Container -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{006A2A75-547F-11D1-B930-00A0C9A06D2D}\NodeTypes\{BF967A8B-0DE6-11D0-A285-00AA003049E2}"/>
      <!-- OrgUnit -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{006A2A75-547F-11D1-B930-00A0C9A06D2D}\NodeTypes\{bf967aa5-0de6-11d0-a285-00aa003049e2}"/>
      <!-- inetOrgPerson -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{006A2A75-547F-11D1-B930-00A0C9A06D2D}\NodeTypes\{4828cc14-1437-45bc-9b07-ad6f015e5f28}"/>
      <!-- userProxy -->
      <RegistryKey Root="HKLM" ForceCreateOnInstall="yes" Key="SOFTWARE\Microsoft\MMC\SnapIns\{006A2A75-547F-11D1-B930-00A0C9A06D2D}\NodeTypes\{60d6186f-f3b6-4898-b0ad-6535afc07620}"/>
     
     <!-- 
     ADSIEdit
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MMC\SnapIns\{1C5DACFA-16BA-11d2-81D0-0000F87A7AA3}\NodeTypes\{072B64B7-CFF7-11d2-8801-00C04F72ED31}
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MMC\SnapIns\{1C5DACFA-16BA-11d2-81D0-0000F87A7AA3}\NodeTypes\{5C225203-CFF7-11d2-8801-00C04F72ED31}
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MMC\SnapIns\{1C5DACFA-16BA-11d2-81D0-0000F87A7AA3}\NodeTypes\{70B9C151-CFF7-11d2-8801-00C04F72ED31}
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MMC\SnapIns\{1C5DACFA-16BA-11d2-81D0-0000F87A7AA3}\NodeTypes\{8690ABBB-CFF7-11d2-8801-00C04F72ED31}
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MMC\SnapIns\{1C5DACFA-16BA-11d2-81D0-0000F87A7AA3}\NodeTypes\{D4F3374F-052F-11d2-97B0-00A0C9A06D2D}

     
      --> 
    </Component>
            
    <Feature Id='Complete' Level='1'>
    <!-- 
      <ComponentRef Id='MainExecutable' />
      <ComponentRef Id='HelperLibrary' />
      <ComponentRef Id='Manual' />
      <ComponentRef Id='ProgramMenuDir' />
       -->
      <ComponentRef Id='MMC' />
    </Feature>

    <Icon Id="Foobar10.exe" SourceFile="FoobarAppl10.exe" />

  </Product>
</Wix>
